import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as e,o as t,c as p,a as n,b as i,d as c,e as l}from"./app-Ba--U_Af.js";const o={},r=l(`<h1 id="docker搭建redis集群" tabindex="-1"><a class="header-anchor" href="#docker搭建redis集群"><span>Docker搭建redis集群</span></a></h1><h2 id="脚本" tabindex="-1"><a class="header-anchor" href="#脚本"><span>脚本</span></a></h2><p>创建节点数据</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token keyword">for</span> <span class="token for-or-select variable">port</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">6</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token punctuation">\\</span>
<span class="token keyword">do</span> <span class="token punctuation">\\</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> ./node-<span class="token variable">\${port}</span>/conf
<span class="token function">touch</span> ./node-<span class="token variable">\${port}</span>/conf/redis.conf
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span> ./node-<span class="token variable">\${port}</span>/conf/redis.conf</span>
port 800<span class="token variable">\${port}</span>
bind 0.0.0.0
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
cluster-announce-ip 10.8.46.98
cluster-announce-port 800<span class="token variable">\${port}</span>
cluster-announce-bus-port 1800<span class="token variable">\${port}</span>
appendonly yes
EOF</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="启动" tabindex="-1"><a class="header-anchor" href="#启动"><span>启动</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 容器1</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> redis-1 <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-1/data:/data <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-1/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> <span class="token function">host</span>  redis:5.0.12 redis-server /etc/redis/redis.conf

<span class="token comment"># 容器2</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> redis-2 <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-2/data:/data <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-2/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> <span class="token function">host</span>  redis:5.0.12 redis-server /etc/redis/redis.conf

<span class="token comment"># 容器3</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> redis-3 <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-3/data:/data <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-3/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> <span class="token function">host</span>  redis:5.0.12 redis-server /etc/redis/redis.conf

<span class="token comment"># 容器4</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> redis-4 <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-4/data:/data <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-4/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> <span class="token function">host</span>  redis:5.0.12 redis-server /etc/redis/redis.conf

<span class="token comment"># 容器5</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> redis-5 <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-5/data:/data <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-5/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> <span class="token function">host</span>  redis:5.0.12 redis-server /etc/redis/redis.conf

<span class="token comment"># 容器6</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> redis-6 <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-6/data:/data <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">pwd</span><span class="token variable">\`</span></span>/node-6/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> <span class="token function">host</span>  redis:5.0.12 redis-server /etc/redis/redis.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="停止" tabindex="-1"><a class="header-anchor" href="#停止"><span>停止</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span> stop redis-1
<span class="token function">docker</span> stop redis-2
<span class="token function">docker</span> stop redis-3
<span class="token function">docker</span> stop redis-4
<span class="token function">docker</span> stop redis-5
<span class="token function">docker</span> stop redis-6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="删除" tabindex="-1"><a class="header-anchor" href="#删除"><span>删除</span></a></h2><div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>for port in $(seq 1 6); \\                                                                                                                                                                                  
do \\                                                                                                                                                                                                       
docker stop redis-\${port}                                                                                                                                                                                  
docker rm redis-\${port}                                                                                                                                                                                    
done
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="docker-compose版本" tabindex="-1"><a class="header-anchor" href="#docker-compose版本"><span>docker-compose版本</span></a></h2><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.1&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token comment"># redis1配置</span>
  <span class="token key atrule">redis1</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>6.2.5
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span><span class="token number">1</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./node<span class="token punctuation">-</span>1/conf/redis.conf<span class="token punctuation">:</span>/usr/local/etc/redis/redis.conf
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8001:8001&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;18001:18001&quot;</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/local/etc/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token comment"># redis2配置</span>
  <span class="token key atrule">redis2</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>6.2.5
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span><span class="token number">2</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./node<span class="token punctuation">-</span>2/conf/redis.conf<span class="token punctuation">:</span>/usr/local/etc/redis/redis.conf
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8002:8002&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;18002:18002&quot;</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/local/etc/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token comment"># redis3配置</span>
  <span class="token key atrule">redis3</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>6.2.5
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span><span class="token number">3</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./node<span class="token punctuation">-</span>3/conf/redis.conf<span class="token punctuation">:</span>/usr/local/etc/redis/redis.conf
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8003:8003&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;18003:18003&quot;</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/local/etc/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token comment"># redis4配置</span>
  <span class="token key atrule">redis4</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>6.2.5
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span><span class="token number">4</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./node<span class="token punctuation">-</span>4/conf/redis.conf<span class="token punctuation">:</span>/usr/local/etc/redis/redis.conf
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8004:8004&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;18004:18004&quot;</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/local/etc/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token comment"># redis5配置</span>
  <span class="token key atrule">redis5</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>6.2.5
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span><span class="token number">5</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./node<span class="token punctuation">-</span>5/conf/redis.conf<span class="token punctuation">:</span>/usr/local/etc/redis/redis.conf
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8005:8005&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;18005:18005&quot;</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/local/etc/redis/redis.conf&quot;</span><span class="token punctuation">]</span>
  <span class="token comment"># redis6配置</span>
  <span class="token key atrule">redis6</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>6.2.5
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span><span class="token number">6</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./node<span class="token punctuation">-</span>6/conf/redis.conf<span class="token punctuation">:</span>/usr/local/etc/redis/redis.conf
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8006:8006&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;18006:18006&quot;</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;redis-server&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/local/etc/redis/redis.conf&quot;</span><span class="token punctuation">]</span>

<span class="token comment">#redis-cli --cluster create 192.168.1.110:8001 192.168.1.110:8002 192.168.1.110:8003 192.168.1.110:8004 192.168.1.110:8005 192.168.1.110:8006 --cluster-replicas 0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="资料" tabindex="-1"><a class="header-anchor" href="#资料"><span>资料</span></a></h2>`,13),d={href:"https://cloud.tencent.com/developer/article/1838120",target:"_blank",rel:"noopener noreferrer"};function u(k,v){const s=e("ExternalLinkIcon");return t(),p("div",null,[r,n("p",null,[n("a",d,[i("Docker搭建Redis Cluster集群 "),c(s)])])])}const f=a(o,[["render",u],["__file","Docker搭建redis集群.html.vue"]]),h=JSON.parse('{"path":"/tech/redis/Docker%E6%90%AD%E5%BB%BAredis%E9%9B%86%E7%BE%A4.html","title":"Docker搭建redis集群","lang":"zh-CN","frontmatter":{"date":"2022-11-06T22:25:00.000Z","category":["Redis"],"tag":["Docker","Redis"],"description":"Docker搭建redis集群 脚本 创建节点数据 启动 停止 删除 docker-compose版本 资料 Docker搭建Redis Cluster集群","head":[["meta",{"property":"og:url","content":"https://dhbin.cn/tech/redis/Docker%E6%90%AD%E5%BB%BAredis%E9%9B%86%E7%BE%A4.html"}],["meta",{"property":"og:site_name","content":"HB技术栈"}],["meta",{"property":"og:title","content":"Docker搭建redis集群"}],["meta",{"property":"og:description","content":"Docker搭建redis集群 脚本 创建节点数据 启动 停止 删除 docker-compose版本 资料 Docker搭建Redis Cluster集群"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-03-23T12:17:45.000Z"}],["meta",{"property":"article:author","content":"DHB"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:tag","content":"Redis"}],["meta",{"property":"article:published_time","content":"2022-11-06T22:25:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-03-23T12:17:45.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Docker搭建redis集群\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-11-06T22:25:00.000Z\\",\\"dateModified\\":\\"2023-03-23T12:17:45.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"DHB\\",\\"url\\":\\"https://dhbin.cn\\"}]}"]]},"headers":[{"level":2,"title":"脚本","slug":"脚本","link":"#脚本","children":[]},{"level":2,"title":"启动","slug":"启动","link":"#启动","children":[]},{"level":2,"title":"停止","slug":"停止","link":"#停止","children":[]},{"level":2,"title":"删除","slug":"删除","link":"#删除","children":[]},{"level":2,"title":"docker-compose版本","slug":"docker-compose版本","link":"#docker-compose版本","children":[]},{"level":2,"title":"资料","slug":"资料","link":"#资料","children":[]}],"git":{"createdTime":1679573865000,"updatedTime":1679573865000,"contributors":[{"name":"dhb","email":"xx158@qq.com","commits":1}]},"readingTime":{"minutes":1.55,"words":464},"localizedDate":"2022年11月6日","excerpt":"\\n<h2>脚本</h2>\\n<p>创建节点数据</p>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"token keyword\\">for</span> <span class=\\"token for-or-select variable\\">port</span> <span class=\\"token keyword\\">in</span> <span class=\\"token variable\\"><span class=\\"token variable\\">$(</span><span class=\\"token function\\">seq</span> <span class=\\"token number\\">1</span> <span class=\\"token number\\">6</span><span class=\\"token variable\\">)</span></span><span class=\\"token punctuation\\">;</span> <span class=\\"token punctuation\\">\\\\</span>\\n<span class=\\"token keyword\\">do</span> <span class=\\"token punctuation\\">\\\\</span>\\n<span class=\\"token function\\">mkdir</span> <span class=\\"token parameter variable\\">-p</span> ./node-<span class=\\"token variable\\">${port}</span>/conf\\n<span class=\\"token function\\">touch</span> ./node-<span class=\\"token variable\\">${port}</span>/conf/redis.conf\\n<span class=\\"token function\\">cat</span> <span class=\\"token operator\\">&lt;&lt;</span> <span class=\\"token string\\">EOF<span class=\\"token bash punctuation\\"> <span class=\\"token operator\\">&gt;</span> ./node-<span class=\\"token variable\\">${port}</span>/conf/redis.conf</span>\\nport 800<span class=\\"token variable\\">${port}</span>\\nbind 0.0.0.0\\ncluster-enabled yes\\ncluster-config-file nodes.conf\\ncluster-node-timeout 5000\\ncluster-announce-ip 10.8.46.98\\ncluster-announce-port 800<span class=\\"token variable\\">${port}</span>\\ncluster-announce-bus-port 1800<span class=\\"token variable\\">${port}</span>\\nappendonly yes\\nEOF</span>\\n<span class=\\"token keyword\\">done</span>\\n</code></pre></div>","autoDesc":true}');export{f as comp,h as data};
